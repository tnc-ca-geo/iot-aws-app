<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Lora Tracker</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="styles/styles.css">
    <link rel="stylesheet" href="https://js.arcgis.com/4.14/esri/css/main.css">
    <link rel="stylesheet" href="https://js.arcgis.com/4.14/esri/themes/dark/main.css">
  </head>
  <body>
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
    <div id="map"></div>
    <div id="filters">
      <h3>Filter transmissions</h3>
      <h3>Time</h3>
      <section id="intervalFilter">
        <div>
          <input type="radio" id="ten-day" name="interval" value="14400">
          <label for="ten-dat">Last 10 days</label>
        </div>
        <div>
          <input type="radio" id="day" name="interval" value="1440">
          <label for="day">Last day</label>
        </div>
        <div>
          <input type="radio" id="hour" name="interval" value="60">
          <label for="hour">Last hour</label>
        </div>
        <div>
          <input type="radio" id="ten-min" name="interval" value="10" checked>
          <label for="ten-min">Last 10 minutes</label>
        </div>
        <div>
          <input type="radio" id="one-min" name="interval" value="1">
          <label for="one-min">Last minute</label>
        </div>
      </section>
      <h3>Devices</h3>
      <section id="devFilter"></section>
      <h3>Gateways</h3>
      <selection id="gatewayFilter"></selection>
    </div>
    <div class="ui-button" id="refresh-button">
      <span class="esri-icon-refresh"></span>
    </div>
  </body>

  <script>
    /*
      * TODO: is this URL trick necessary? 
      * Added it to make s3 and localhost happy, but perhaps I'm just not using 
      * dojoConfig corectly. Beforehand the locations were relative URLs 
      * ("/app/modules", "/config" etc.) and they worked fine on localhost but 
      * not on s3.
      * NOTE: appending location.pathname.replace(/\/[^/]+$/, '') to the 
      * relative URLs (eg. location.pathname.replace(/\/[^/]+$/, '') + 
      * 'app/modules') makes it work on s3 but not localhost...
      */

    var url = location.href;
    var re = /\/[^\/]+$/;
    if (url.indexOf('?') !== -1) {
      url = location.href.match(/^[^?]+/)[0];   // Get the URL of this page without the query string
    } else if (url.indexOf('#') !== -1) {
      url = location.href.match(/^[^#]+/)[0];   // Get the URL of this page without the hash string
    };
    if (re.test(url)) {   // Remove the document filename if present.
      url = url.replace(re, '/');
    };    

    var dojoConfig = {
      packages: [{
        name: 'modules',
        location: url + 'js/modules'
      },
      {
        name: 'config',
        location: url + 'js/config'
      }]
    };
  </script>

  <script src="https://js.arcgis.com/4.14/"></script>  
  <!-- END ESRI scripts/css -->

  <script src="js/index.js" defer></script>
</html>